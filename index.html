<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title> åˆ†æ½¤è¨ˆç®— </title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body {
      font-family: 'Noto Sans TC', sans-serif;
      background-color: #fbeaea;
      margin: 0;
      padding: 0;
    }
    .container {
      display: flex;
      min-height: 100vh;
      width: 100%;
      box-sizing: border-box;
    }
    .left-panel {
      width: 40%;
      padding: 2rem;
      background-color: #f9eaea;
      color: #5b4331;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
    }
    .left-panel h1 {
      margin-top: 0;
      font-size: 2rem;
      color: #b23a48;
    }
    .left-panel p {
      font-size: 1rem;
      margin-bottom: 1.5rem;
      max-width: 400px;
    }
    .left-panel ul {
      padding-left: 0;
      font-size: 1rem;
      list-style-position: inside;
      max-width: 400px;
      margin: 0 auto;
      text-align: left;
    }
    .left-panel li {
      margin-bottom: 0.7em;
    }
    .right-panel {
      width: 60%;
      padding: 2rem;
      background-color: #fff7f1;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .result-box {
      background-color: #fff8f4;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(150, 115, 90, 0.1);
      padding: 2rem;
      color: #5c4a3c;
      max-width: 520px;
      margin: 0 auto;
      text-align: left;
      display: none;
    }
    .result-title {
      text-align: center;
      color: #b23a48;
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 2rem;
    }
    .result-item {
      font-size: 1rem;
      margin-bottom: 1.2rem;
      font-weight: bold;
      color: #5c4a3c;
    }
    .result-label {
      font-weight: bold;
      color: #b23a48;
    }
    .result-value {
      font-weight: normal;
      color: #5c4a3c;
      margin-left: 0.5em;
    }
    .selfbuy-list {
      margin: 0 0 1em 0;
      padding: 0.8em 1em;
      background: #fbeaea;
      border-radius: 8px;
      color: #b23a48;
      font-size: 0.98em;
    }
    .selfbuy-person {
      margin-bottom: 0.7em;
    }
    .selfbuy-item {
      margin-left: 1.2em;
      display: list-item;
      list-style: disc inside;
      color: #6d2e2e;
    }
    button {
      padding: 0.8rem 1.5rem;
      background-color: #d8bfa6;
      border: none;
      border-radius: 8px;
      color: #fff;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      margin-top: 1.5rem;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    button:hover {
      background-color: #c5aa91;
    }
    @media (max-width: 950px) {
      .container {
        flex-direction: column;
      }
      .left-panel, .right-panel {
        width: 100%;
        padding: 1.2rem;
      }
      .result-box {
        padding: 1rem;
      }
      .left-panel ul {
        text-align: left;
        max-width: 100%;
      }
    }
    form {
      background-color: #fff8f4;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(150, 115, 90, 0.2);
      padding: 2rem;
      width: 100%;
      max-width: 600px;
      color: #5c4a3c;
      margin: 0 auto;
    }
    h2, h3 {
      text-align: center;
      color: #b23a48;
    }
    label {
      display: block;
      margin-top: 1rem;
      margin-bottom: 0.3rem;
      font-weight: bold;
    }
    input {
      width: 100%;
      padding: 0.5rem;
      border: 1px solid #eabbbb;
      border-radius: 6px;
      background-color: #fff;
      font-size: 1rem;
    }
    .button-group {
      display: flex;
      justify-content: space-between;
      margin-top: 2rem;
    }
    .step {
      display: none;
    }
    .step.active {
      display: block;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="left-panel">
      <h1> ROLMIE ç§å¯†å‘µè­·åˆ†æ½¤è¨ˆç®—</h1>
      <p>è¼•é¬†è¨ˆç®—æ¯æœˆåˆ†æ½¤èˆ‡æè´ˆé‡‘é¡ï¼Œæ¸…æ¥šæ˜ç­åˆ†é…æ˜ç´°ã€‚</p>
      <ul>
        <li>âœ”ï¸ åªé¡¯ç¤ºæœ‰è‡ªè³¼çš„é …ç›®åŠé‡‘é¡</li>
        <li>âœ”ï¸ å„äººè‡ªè³¼æ˜ç´°ã€åˆ†æ½¤ã€æè´ˆå…¨è‡ªå‹•</li>
      </ul>
    </div>
    <div class="right-panel">
      <form id="rolmieForm">
        <h2> å¡«è¡¨æ˜ç´° </h2>
        <!-- Step 1 -->
        <div class="step active" id="step1">
          <h3>å¡«å¯«æœ¬æœˆæ•¸æ“š</h3>
          <label for="month">æœˆä»½ï¼ˆå¦‚ 2024-06ï¼‰</label>
          <input id="month" name="month" type="text" required />

          <label for="total_amount">ç¸½ç‡Ÿæ¥­é¡</label>
          <input id="total_amount" name="total_amount" type="number" required />

          <label for="jia_wash">ä½³è‡»è‡ªè³¼ï¼ç§å¯†æ´—æ•¸é‡</label>
          <input id="jia_wash" name="jia_wash" type="number" value="0" min="0" />

          <label for="jia_essence">ä½³è‡»è‡ªè³¼ï¼ç²¾è¯æ•¸é‡</label>
          <input id="jia_essence" name="jia_essence" type="number" value="0" min="0" />

          <label for="jia_oil">ä½³è‡»è‡ªè³¼ï¼ç§å¯†æ²¹æ•¸é‡</label>
          <input id="jia_oil" name="jia_oil" type="number" value="0" min="0" />

          <label for="jia_mask">ä½³è‡»è‡ªè³¼ï¼æ•·è†œæ•¸é‡</label>
          <input id="jia_mask" name="jia_mask" type="number" value="0" min="0" />

          <label for="vicky_wash">vickyè‡ªè³¼ï¼ç§å¯†æ´—æ•¸é‡</label>
          <input id="vicky_wash" name="vicky_wash" type="number" value="0" min="0" />

          <label for="vicky_essence">vickyè‡ªè³¼ï¼ç²¾è¯æ•¸é‡</label>
          <input id="vicky_essence" name="vicky_essence" type="number" value="0" min="0" />

          <label for="vicky_oil">vickyè‡ªè³¼ï¼ç§å¯†æ²¹æ•¸é‡</label>
          <input id="vicky_oil" name="vicky_oil" type="number" value="0" min="0" />

          <label for="vicky_mask">vickyè‡ªè³¼ï¼æ•·è†œæ•¸é‡</label>
          <input id="vicky_mask" name="vicky_mask" type="number" value="0" min="0" />

          <label for="zong_wash">å®—æ†²è‡ªè³¼ï¼ç§å¯†æ´—æ•¸é‡</label>
          <input id="zong_wash" name="zong_wash" type="number" value="0" min="0" />

          <label for="zong_essence">å®—æ†²è‡ªè³¼ï¼ç²¾è¯æ•¸é‡</label>
          <input id="zong_essence" name="zong_essence" type="number" value="0" min="0" />

          <label for="zong_oil">å®—æ†²è‡ªè³¼ï¼ç§å¯†æ²¹æ•¸é‡</label>
          <input id="zong_oil" name="zong_oil" type="number" value="0" min="0" />

          <label for="zong_mask">å®—æ†²è‡ªè³¼ï¼æ•·è†œæ•¸é‡</label>
          <input id="zong_mask" name="zong_mask" type="number" value="0" min="0" />

          <div class="button-group">
            <button type="button" onclick="nextStep(2)">ä¸‹ä¸€æ­¥ â–¶</button>
          </div>
        </div>
        <!-- Step 2 -->
        <div class="step" id="step2">
          <h3>ç¢ºèªè‡ªè³¼é‡‘é¡</h3>
          <div id="selfBuySummary" style="margin-bottom:1.2rem;color:#b23a48;font-weight:bold;text-align:center;"></div>
          <div class="button-group">
            <button type="button" onclick="nextStep(1)">â—€ ä¸Šä¸€æ­¥</button>
            <button type="button" onclick="submitForm()">ğŸ“® é€å‡º</button>
          </div>
        </div>
      </form>
      <!-- çµæœé  -->
      <div id="resultBox" class="result-box">
        <div class="result-title">åˆ†æ½¤è¨ˆç®—çµæœ</div>
        <div class="result-item">
          <span class="result-label">æœˆä»½ï¼š</span>
          <span id="resultMonth" class="result-value"></span>
        </div>
        <div class="result-item">
          <span class="result-label">ç¸½ç‡Ÿæ¥­é¡ï¼š</span>
          <span id="resultTotalAmount" class="result-value"></span> å…ƒ
        </div>
        <div class="result-item">
          <span class="result-label">æ·¨åˆ©æ½¤ (10%)ï¼š</span>
          <span id="resultNetProfit" class="result-value"></span> å…ƒ
        </div>
        <div class="result-item">
          <span class="result-label">è‡ªè³¼æ˜ç´°ï¼š</span>
          <div id="resultSelfBuyList" class="selfbuy-list"></div>
        </div>
        <div class="result-item">
          <span class="result-label">ä½³è‡»åˆ†æ½¤ (33%)ï¼š</span>
          <span id="resultJiaShare" class="result-value"></span> å…ƒ
        </div>
        <div class="result-item">
          <span class="result-label">vickyåˆ†æ½¤ (33.5%)ï¼š</span>
          <span id="resultVickyShare" class="result-value"></span> å…ƒ
        </div>
        <div class="result-item">
          <span class="result-label">å®—æ†²åˆ†æ½¤ (33.5%)ï¼š</span>
          <span id="resultZongShare" class="result-value"></span> å…ƒ
        </div>
        <div class="result-item">
          <span class="result-label">æè´ˆé‡‘é¡ (1%)ï¼š</span>
          <span id="resultDonate" class="result-value"></span> å…ƒ
        </div>
        <div class="result-item">
          <span class="result-label">æè´ˆåˆ†ç­†å»ºè­°ï¼š</span>
          <span id="resultDonateMulti" class="result-value"></span>
        </div>
        <button type="button" onclick="restartForm()">é‡æ–°å¡«å¯«</button>
      </div>
    </div>
  </div>
  <script>
    // å•†å“å–®åƒ¹
    const PRICE = {
      wash: 448,
      essence: 448,
      oil: 518,
      mask: 450
    };

    function nextStep(step) {
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById('step' + step).classList.add('active');
      document.getElementById('resultBox').style.display = 'none';
      if (step === 2) {
        updateSelfBuySummary();
      }
    }

    function calcSelfBuy(obj) {
      return (
        (Number(obj.wash || 0) * PRICE.wash) +
        (Number(obj.essence || 0) * PRICE.essence) +
        (Number(obj.oil || 0) * PRICE.oil) +
        (Number(obj.mask || 0) * PRICE.mask)
      );
    }

    function buildSelfBuyDetail(obj) {
      let arr = [];
      if (obj.wash > 0) arr.push(`ç§å¯†æ´— x${obj.wash}ï¼ˆ${obj.wash * PRICE.wash}å…ƒï¼‰`);
      if (obj.essence > 0) arr.push(`ç²¾è¯ x${obj.essence}ï¼ˆ${obj.essence * PRICE.essence}å…ƒï¼‰`);
      if (obj.oil > 0) arr.push(`ç§å¯†æ²¹ x${obj.oil}ï¼ˆ${obj.oil * PRICE.oil}å…ƒï¼‰`);
      if (obj.mask > 0) arr.push(`æ•·è†œ x${obj.mask}ï¼ˆ${obj.mask * PRICE.mask}å…ƒï¼‰`);
      return arr;
    }

    function updateSelfBuySummary() {
      const form = document.getElementById('rolmieForm');
      const jia = {
        wash: Number(form.jia_wash.value) || 0,
        essence: Number(form.jia_essence.value) || 0,
        oil: Number(form.jia_oil.value) || 0,
        mask: Number(form.jia_mask.value) || 0,
      };
      const vicky = {
        wash: Number(form.vicky_wash.value) || 0,
        essence: Number(form.vicky_essence.value) || 0,
        oil: Number(form.vicky_oil.value) || 0,
        mask: Number(form.vicky_mask.value) || 0,
      };
      const zong = {
        wash: Number(form.zong_wash.value) || 0,
        essence: Number(form.zong_essence.value) || 0,
        oil: Number(form.zong_oil.value) || 0,
        mask: Number(form.zong_mask.value) || 0,
      };
      let html = '';
      function personBlock(name, obj) {
        let detail = buildSelfBuyDetail(obj);
        if (detail.length === 0) return '';
        return `<div class="selfbuy-person"><b>${name}ï¼š</b><ul style="margin:0;padding:0;">${detail.map(i=>`<li class="selfbuy-item">${i}</li>`).join('')}</ul>ç¸½é‡‘é¡ï¼š${calcSelfBuy(obj).toLocaleString()}å…ƒ</div>`;
      }
      html += personBlock('ä½³è‡»', jia);
      html += personBlock('vicky', vicky);
      html += personBlock('å®—æ†²', zong);
      document.getElementById('selfBuySummary').innerHTML = html || 'ç„¡è‡ªè³¼';
    }

    function submitForm() {
      const form = document.getElementById('rolmieForm');
      const month = form.month.value;
      const totalAmount = Number(form.total_amount.value);

      // è‡ªè³¼æ˜ç´°
      const jia = {
        wash: Number(form.jia_wash.value) || 0,
        essence: Number(form.jia_essence.value) || 0,
        oil: Number(form.jia_oil.value) || 0,
        mask: Number(form.jia_mask.value) || 0,
      };
      const vicky = {
        wash: Number(form.vicky_wash.value) || 0,
        essence: Number(form.vicky_essence.value) || 0,
        oil: Number(form.vicky_oil.value) || 0,
        mask: Number(form.vicky_mask.value) || 0,
      };
      const zong = {
        wash: Number(form.zong_wash.value) || 0,
        essence: Number(form.zong_essence.value) || 0,
        oil: Number(form.zong_oil.value) || 0,
        mask: Number(form.zong_mask.value) || 0,
      };

      // æ·¨åˆ©æ½¤
      const netProfit = Math.round(totalAmount * 0.10);

      // åˆ†æ½¤è¨ˆç®—
      const jiaSelf = calcSelfBuy(jia);
      const vickySelf = calcSelfBuy(vicky);
      const zongSelf = calcSelfBuy(zong);
      const jiaShare = Math.round(netProfit * 0.33 - jiaSelf);
      const vickyShare = Math.round(netProfit * 0.335 - vickySelf);
      const zongShare = Math.round(netProfit * 0.335 - zongSelf);
      const donate = Math.round(totalAmount * 0.01);

      // æè´ˆåˆ†ç­†
      let donateMulti = '';
      if (donate >= 4000) {
        const per = Math.floor(donate/3);
        const rest = donate - per*2;
        donateMulti = `åˆ†ä¸‰ç­†ï¼š${per}ã€${per}ã€${rest} å…ƒ`;
      } else if (donate >= 3000) {
        const per = Math.floor(donate/2);
        const rest = donate - per;
        donateMulti = `åˆ†å…©ç­†ï¼š${per}ã€${rest} å…ƒ`;
      } else {
        donateMulti = `å–®ç­†ï¼š${donate} å…ƒ`;
      }

      // æ§‹å»ºè‡ªè³¼é¡¯ç¤ºï¼ˆåªåˆ—æœ‰è‡ªè³¼çš„é …ç›®ï¼‰
      function personBlock(name, obj) {
        let detail = buildSelfBuyDetail(obj);
        if (detail.length === 0) return '';
        return `<div class="selfbuy-person"><b>${name}ï¼š</b><ul style="margin:0;padding:0;">${detail.map(i=>`<li class="selfbuy-item">${i}</li>`).join('')}</ul>ç¸½é‡‘é¡ï¼š${calcSelfBuy(obj).toLocaleString()}å…ƒ</div>`;
      }
      let selfBuyHtml = '';
      selfBuyHtml += personBlock('ä½³è‡»', jia);
      selfBuyHtml += personBlock('vicky', vicky);
      selfBuyHtml += personBlock('å®—æ†²', zong);
      document.getElementById('resultSelfBuyList').innerHTML = selfBuyHtml || 'ç„¡è‡ªè³¼';

      // é¡¯ç¤ºçµæœé 
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById('resultBox').style.display = 'block';
      document.getElementById('resultMonth').textContent = month;
      document.getElementById('resultTotalAmount').textContent = totalAmount.toLocaleString();
      document.getElementById('resultNetProfit').textContent = netProfit.toLocaleString();
      document.getElementById('resultJiaShare').textContent = jiaShare.toLocaleString();
      document.getElementById('resultVickyShare').textContent = vickyShare.toLocaleString();
      document.getElementById('resultZongShare').textContent = zongShare.toLocaleString();
      document.getElementById('resultDonate').textContent = donate.toLocaleString();
      document.getElementById('resultDonateMulti').textContent = donateMulti;
    }

    function restartForm() {
      document.getElementById('rolmieForm').reset();
      nextStep(1);
      document.getElementById('resultBox').style.display = 'none';
      document.getElementById('selfBuySummary').innerHTML = '';
    }
  </script>
</body>
</html>
